{
  "name": "AI Cinema",
  "nodes": [
    {
      "parameters": {
        "updates": [
          "message"
        ],
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.2,
      "position": [
        -144,
        16
      ],
      "id": "72539dc8-d72d-4ea4-ab28-40a426a9b406",
      "name": "Telegram Trigger",
      "webhookId": "61c6824d-f693-4d3b-87aa-e7985aa1b72f",
      "credentials": {
        "telegramApi": {
          "id": "7yMEQbBPOBUDZKED",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "url": "https://api.themoviedb.org/3/movie/now_playing",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "api_key",
              "value": "2da0cea0af334ab7e1bfeacbf330826a"
            },
            {
              "name": "language",
              "value": "vi-VN"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        224,
        16
      ],
      "id": "10a60c5f-2e74-4fcd-8630-7baacfa77944",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=[VAI TRÃ’]\nBáº¡n lÃ  Trá»£ lÃ½ AI cÃ¡ nhÃ¢n thÃ´ng minh vÃ  táº­n tá»¥y.\n\n[Dá»® LIá»†U Äáº¦U VÃ€O]\nDanh sÃ¡ch phim (JSON): {{ JSON.stringify($json.results) }}\n\n[CÃ‚U Há»ŽI Cá»¦A NGÆ¯á»œI DÃ™NG]\n\"{{ $('Telegram Trigger').item.json.message.text }}\"\n\n[NHIá»†M Vá»¤ PHÃ‚N TÃCH]\nHÃ£y Ä‘á»c ká»¹ cÃ¢u há»i cá»§a ngÆ°á»i dÃ¹ng vÃ  chá»n 1 trong 2 cÃ¡ch pháº£n há»“i sau:\n\n--- TRÆ¯á»œNG Há»¢P 1: NGÆ¯á»œI DÃ™NG MUá»N Gá»¢I Ã (CHUNG HOáº¶C THEO THá»‚ LOáº I) ---\n(VÃ­ dá»¥: \"Phim gÃ¬ hay?\", \"TÃ¬m phim kinh dá»‹\", \"ThÃ­ch xem phim tÃ¬nh cáº£m\", \"CÃ³ phim hoáº¡t hÃ¬nh khÃ´ng?\")\n\n-> BÆ¯á»šC 1 (QUAN TRá»ŒNG): Kiá»ƒm tra xem ngÆ°á»i dÃ¹ng cÃ³ nháº¯c Ä‘áº¿n thá»ƒ loáº¡i cá»¥ thá»ƒ nÃ o khÃ´ng (Kinh dá»‹, HÃ i, HÃ nh Ä‘á»™ng...)?\n   - Náº¾U CÃ“: HÃ£y lá»c danh sÃ¡ch vÃ  chá»‰ chá»n ra 3 phim thuá»™c Ä‘Ãºng thá»ƒ loáº¡i Ä‘Ã³ (hoáº·c gáº§n giá»‘ng nháº¥t).\n   - Náº¾U KHÃ”NG (há»i chung chung): HÃ£y chá»n 3 phim cÃ³ Ä‘iá»ƒm Ä‘Ã¡nh giÃ¡ cao nháº¥t/hot nháº¥t.\n\n-> BÆ¯á»šC 2: TrÃ¬nh bÃ y theo cáº¥u trÃºc:\n   ChÃ o báº¡n, dá»±a theo sá»Ÿ thÃ­ch cá»§a báº¡n, mÃ¬nh tÃ¬m Ä‘Æ°á»£c 3 phim nÃ y:\n   1. TÃŠN PHIM (VIáº¾T HOA) - [Ghi chÃº thá»ƒ loáº¡i, vÃ­ dá»¥: Phim Kinh Dá»‹]\n   Review: [Review ngáº¯n gá»n, táº­p trung vÃ o yáº¿u tá»‘ ngÆ°á»i dÃ¹ng thÃ­ch. VD: \"Phim nÃ y dá»a ma cá»±c sá»£...\"]\n   Lá»i khuyÃªn: [CÃ¢u thÃºc giá»¥c nháº¹ nhÃ ng]\n   (Láº·p láº¡i cho 3 phim)\n\n--- TRÆ¯á»œNG Há»¢P 2: NGÆ¯á»œI DÃ™NG Há»ŽI CHI TIáº¾T Vá»€ Má»˜T PHIM Cá»¤ THá»‚ ---\n(VÃ­ dá»¥: \"NÃ³i rÃµ hÆ¡n vá» phim Äáº¥t Rá»«ng PhÆ°Æ¡ng Nam\", \"Review phim Mai\", \"Ná»™i dung phim nÃ y lÃ  gÃ¬?\")\n-> TÃ¬m Ä‘Ãºng bá»™ phim Ä‘Ã³ trong danh sÃ¡ch dá»¯ liá»‡u.\n-> Viáº¿t má»™t bÃ i review chi tiáº¿t, sÃ¢u sáº¯c hÆ¡n vá» ná»™i dung, diá»…n viÃªn cá»§a RIÃŠNG phim Ä‘Ã³.\n-> Tráº£ lá»i trá»±c tiáº¿p vÃ o cÃ¢u há»i, khÃ´ng cáº§n liá»‡t kÃª cÃ¡c phim khÃ¡c.\n\n[QUY Táº®C CHUNG]\n- XÆ°ng hÃ´: \"MÃ¬nh\" - \"Báº¡n\".\n- Giá»ng vÄƒn: ThÃ¢n thiá»‡n, tá»± nhiÃªn.\n- Náº¿u khÃ´ng tÃ¬m tháº¥y phim nÃ o Ä‘Ãºng thá»ƒ loáº¡i yÃªu cáº§u, hÃ£y xin lá»—i khÃ©o vÃ  gá»£i Ã½ phim hot khÃ¡c.",
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.9,
      "position": [
        400,
        16
      ],
      "id": "9721b69a-7898-4e47-8794-edcc260c352e",
      "name": "Basic LLM Chain",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "={{$json.text.replace(/[*_`\\[\\]()]/g, '') }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        752,
        16
      ],
      "id": "59e9dcae-7c92-4672-8a42-fec88c65ee55",
      "name": "Send a text message",
      "webhookId": "c48a9c8d-c289-4b0f-9edf-b7bd20c79b0d",
      "credentials": {
        "telegramApi": {
          "id": "7yMEQbBPOBUDZKED",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "model": "llama-3.3-70b-versatile",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGroq",
      "typeVersion": 1,
      "position": [
        480,
        144
      ],
      "id": "9a2aed76-db9f-4cad-b94a-6dee223e5e40",
      "name": "Groq Chat Model",
      "credentials": {
        "groqApi": {
          "id": "Q9enq2gdiaEOCMmh",
          "name": "Groq account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.message.text }}",
                    "rightValue": "^\\/",
                    "operator": {
                      "type": "string",
                      "operation": "regex"
                    },
                    "id": "b1716251-e1a1-486d-ab74-d2c8e5c34fa7"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": "={{ false }}"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "4ecce9ac-b373-4dfb-bb10-80c2bdf1ebc0",
                    "leftValue": "=",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "34ed40da-e059-4e56-981a-8ed0e477f6fa",
                    "leftValue": "={{ $json.message.text }}",
                    "rightValue": "^[Tt]railer\\s",
                    "operator": {
                      "type": "string",
                      "operation": "regex"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        16,
        0
      ],
      "id": "92ce7f97-528d-452c-94e0-fb9ba541f32d",
      "name": "Switch"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=Xin chÃ o! ðŸ‘‹\nMÃ¬nh lÃ  trá»£ lÃ½ AI tra cá»©u phim. ðŸŽ¬\nBáº¡n muá»‘n tÃ¬m phim gÃ¬ cá»© nháº¯n tÃªn phim hoáº·c ná»™i dung vÃ o Ä‘Ã¢y Ä‘á»ƒ mÃ¬nh tÃ¬m giÃºp nhÃ©!",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        224,
        -144
      ],
      "id": "a8867cec-5ec7-4a4b-859e-fefa8c76fcd5",
      "name": "Send a text message1",
      "webhookId": "c48a9c8d-c289-4b0f-9edf-b7bd20c79b0d",
      "credentials": {
        "telegramApi": {
          "id": "7yMEQbBPOBUDZKED",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "url": "=https://api.themoviedb.org/3/search/movie",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "api_key",
              "value": "2da0cea0af334ab7e1bfeacbf330826a"
            },
            {
              "name": "query",
              "value": "={{ $json.message.text.replace(/^[Tt]railer\\s/g, '') }}"
            },
            {
              "name": "language",
              "value": "vi-VN"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        224,
        272
      ],
      "id": "5fc8ee2e-504d-465b-b9c8-eb8beaea71bd",
      "name": "Request Movie"
    },
    {
      "parameters": {
        "url": "=https://api.themoviedb.org/3/movie/{{ $json.results[0].id }}/videos",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "api_key",
              "value": "2da0cea0af334ab7e1bfeacbf330826a"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        416,
        272
      ],
      "id": "20b5fdac-f612-435f-9ca3-3e420c63aad4",
      "name": "Request Trailer"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "=ðŸŽ¬ Trailer phim báº¡n yÃªu cáº§u Ä‘Ã¢y:\n\nhttps://www.youtube.com/watch?v={{ $json.results.find(v => v.site === \"YouTube\" && v.type === \"Trailer\")?.key || $json.results[0].key }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        640,
        272
      ],
      "id": "11535295-44e3-4635-b8fc-2fccfcd5ae28",
      "name": "Send Trailer",
      "webhookId": "c48a9c8d-c289-4b0f-9edf-b7bd20c79b0d",
      "credentials": {
        "telegramApi": {
          "id": "7yMEQbBPOBUDZKED",
          "name": "Telegram account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Telegram Trigger": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Basic LLM Chain": {
      "main": [
        [
          {
            "node": "Send a text message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Groq Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Send a text message1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Request Movie",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message1": {
      "main": [
        []
      ]
    },
    "Request Movie": {
      "main": [
        [
          {
            "node": "Request Trailer",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Request Trailer": {
      "main": [
        [
          {
            "node": "Send Trailer",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "91509ab4-1029-4071-b0d5-c71b8a8d8b4a",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "1a49e5d478ba56ca3784671365070ee02a9daf38f4336e68762d758500a9c431"
  },
  "id": "IAG7YkVgizT9qxLSIqJL2",
  "tags": []
}